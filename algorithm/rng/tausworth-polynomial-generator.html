<!doctype html>
<html lang="us">
<head>
<meta charset="utf-8">
<title>Under The Hood: Count-Min Sketching, Configuration &amp; Point-Queries</title>
<link href="../../css/dark-slate/jquery-ui-1.10.4.custom.css" rel="stylesheet">
<link href="../../css/rickshaw.min.css" rel="stylesheet">
<script src="../../js/jquery-1.10.2.js"></script>
<script src="../../js/jquery-ui-1.10.4.custom.js"></script>
<script src="../../js/d3.min.js"></script>
<script src="../../js/rickshaw.min.js"></script>
<script>
$(document).ready(function() {
	
  $("#body").css( "background", "#232323" );

  // Sorter (Rickshaw requires this)
  function sortByX (a,b) {
    if (a.x == b.x) { return 0; }
    return a.x > b.x ? 1 : -1;
  };

  function make_lcg(m, a, c, seed) {
    return function() {
      var next = (a * seed + c) % m;
      seed = next;
      return next / m;
    }
  }

  function make_tausworthe(m, a, c, seed) {
    var __seed = function(x, m) {
      return (x < m) ? x + m : x;
    }
    var __lcg = function(n) {
      return (a * n) & 0xFFFFFFFF; 
    }
    var s1 = __lcg(__seed(seed, 1));
    var s2 = __lcg(__seed(s1, 7));
    var s3 = __lcg(__seed(s2, 15));
    var next32 = function() {
      s1=((s1&4294967294)<<12)^(((s1<<13)^s1)>>19);
      s2=((s2&4294967288)<<4)^(((s2<<2)^s2)>>25);
      s3=((s3&4294967280)<<17)^(((s3<<3)^s3)>>11);
      var r = Math.abs((s1 ^ s2 ^ s3) % m); 
      return r/m;
    }
    next32();
    next32();
    next32();
    next32();
    next32();
    next32();
    return next32;
  }
 
  // Create a tausworth generator that seeds with the super-duper lcg
  var tausworthe = make_tausworthe(0x800000000, 69069, 0, 1);

  function make_data3(generator, size) {
    var count = Array(size*size);
    for(var i = 0; i < size; i++) {
      var pt = {x: Math.floor(size*generator()), y: Math.floor(size*generator())};
      var n = pt.y*size+pt.x;
      count[n] = typeof(count[n]) == 'number' ? count[n]++ : 1; 
    }
    var result = [];
    for(var i = 0; i < count.length; i++) {
      var t = count[i];
      if (count[i] == 1) {
        var pt = {x: i%size, y: i/size};
        result.push(pt);
      }
    }
    return result;
  }

  var make_data = function(generator, n, maxx, maxy) {
    var result = [];
    var count = 0;
    while(count < n) {
      var pt = {x: generator(), y: generator()};
      if (pt.x <= maxx && pt.y <= maxy) {
        result.push(pt);
        result.sort(sortByX);
        count++;
      }
    }
    return result;
  }

  var graph = new Rickshaw.Graph({
    element: document.getElementById("chart"),
    width: 400,
    height: 300,
    renderer: 'scatterplot',
    series: [
     { 
        name: 'MINSTD Spectral Plot Range [0, 0.0015]',
        color: '#6699cc',
        data: make_data(tausworthe, 1024, .0001, .0001)
     }
    ]
  });
  new Rickshaw.Graph.Axis.X({
    graph: graph
  });
  new Rickshaw.Graph.Axis.Y({
    graph: graph
  });
  new Rickshaw.Graph.Legend( {
    graph: graph,
    element: document.getElementById("chart")
  });

  graph.renderer.dotSize = 3;
  graph.render();

});
</script>
<style>
.ui-page { 
  color: #cccccc;
  background: #131313;
}
body {
	font: 85% "Trebuchet MS", sans-serif;
	margin: 75px;
}
</style>
</head>
<body class="ui-page">

<div id="chart">
</div>

<h2>Author</h2>
Eric Crahen
<p>

<h2>References</h2>
http://random.mat.sbg.ac.at/

</body>
</html>
